pipeline{
    agent any
    environment {
        BUILD_NAME = "ganesh_test"
    }
    stages{
        stage("build"){
            when {
                expression {
                    BRANCH_NAME == "main"
                }
            }
            steps{
                echo "Building docker container"
                echo "tagging docker image"
                echo "Current branch name is the ${BRANCH_NAME}" 
                // to get the env variables use https://jenkins_url/env-vars/html
                echo "build name: ${BUILD_NAME}"
            }
        }
        stage("test"){
            when {
                expression {
                    BRANCH_NAME == "dev" || BRANCH_NAME == "test"
                }
            }
            steps{
                echo "testing the application"
            }
        }
    }
    post{
        always{
            echo "build completed"
        }
        success{
            echo "build success"
        }
        failure{
            echo "build failed"
        }
    }
}