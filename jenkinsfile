pipeline{
    agent any
    stages{
        stage("build"){
            when {
                expression {
                    BRANCH_NAME == "main"
                }
            }
            steps{
                echo "Building docker container"
                echo "tagging docker image"
                echo "Current branch name is the ${BRANCH_NAME}"
                echo "hello world"
            }
        }
        stage("test"){
            when {
                expression {
                    BRANCH_NAME == "dev" || BRANCH_NAME == "test"
                }
            }
            steps{
                echo "testing the application"
            }
        }
    }
    post{
        always{
            echo "build completed"
        }
        success{
            echo "build success"
        }
        failure{
            echo "build failed"
        }
    }
}